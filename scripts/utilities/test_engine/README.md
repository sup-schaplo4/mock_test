Perfect! Let me summarize **ALL your requirements** before coding:

---

## **üìã COMPLETE REQUIREMENTS SUMMARY**

---

### **1. Difficulty Distribution within Topics** ‚úÖ
- **Method:** Apply section's overall difficulty ratio proportionally to each topic
- **Example:** 
  - Section needs: 60 questions (25% Easy, 50% Medium, 25% Hard)
  - Topic "Linear Seating" needs: 8 questions
  - Engine picks: 2 Easy, 4 Medium, 2 Hard from Linear Seating

---

### **2. Data Interpretation (DI) Sets - Special Handling** ‚úÖ

#### **A. Atomic Units:**
- Treat entire DI set as one unit (all 5 questions together)
- Cannot split a set

#### **B. Difficulty Footprint Matching (Smart Selection):**

**Algorithm:**
1. **Get Candidate Sets:** Find all DI sets available
2. **Calculate Footprint:** For each set, count difficulty of individual questions:
   - Set A: {Easy: 2, Medium: 2, Hard: 1} = 5 questions
   - Set B: {Easy: 1, Medium: 1, Hard: 3} = 5 questions
   - Set C: {Easy: 0, Medium: 0, Hard: 5} = 5 questions

3. **Check Current Needs:** Section needs: {Easy: 10, Medium: 15, Hard: 5}

4. **Filter Valid Sets:** Keep only sets where footprint ‚â§ needs for ALL difficulties:
   - Set A (1 Hard) ‚úÖ Valid (1 ‚â§ 5)
   - Set B (3 Hard) ‚úÖ Valid (3 ‚â§ 5)
   - Set C (5 Hard) ‚úÖ Valid (5 ‚â§ 5)
   - Set D (6 Hard) ‚ùå Invalid (6 > 5) - REMOVED

5. **Random Selection:** Pick one valid set randomly (e.g., Set B)

6. **Update Quotas:** Subtract Set B's footprint:
   - New needs: {Easy: 9, Medium: 14, Hard: 2}

7. **Repeat:** Continue for next DI set or fill remaining with standalone questions

#### **C. Difficulty Source:**
- Use **question-level difficulty** (not set-level) to calculate footprint
- Ignore set-level difficulty field

---

### **3. Topic Count Validation** ‚úÖ
- Validate: `sum(topic_distribution.values()) == total_questions`
- Hard fail with clear error if mismatch

---

### **4. Seeded Random Selection** ‚úÖ
- Use `test_id` as seed for random number generator
- Same test_id always generates same questions
- Different test_ids generate different questions
- Ensures fairness and reproducibility

---

### **5. No Duplicate Tracking (Phase 1)** ‚úÖ
- Don't track user history across tests
- Each test is independent
- Same user can see same questions in different tests (acceptable)

---

### **6. Source Files - Different JSON Structures** ‚úÖ

You have **5 different master file structures:**

#### **A. English Master** (`english_master.json`):
```json
{
  "metadata": {...},
  "questions": [
    {
      "question_id": "ENG_0001",
      "question": "...",
      "options": {...},
      "correct_answer": "D",
      "difficulty": "Medium",
      "topic": "Reading_Comprehension",
      "subject": "English"
    }
  ]
}
```
- **Key Fields:** `topic`, `difficulty`, `question_id`
- **Total Questions:** 290
- **Topics:** Reading_Comprehension, Fill_in_the_Blanks, Vocabulary, Error_Spotting, Sentence_Correction, Para_Jumbles

---

#### **B. General Awareness Master** (`general_awareness_master.json`):
```json
{
  "metadata": {...},
  "questions": [
    {
      "question_id": "GA_00001",
      "question": "...",
      "options": {...},
      "correct_answer": "B",
      "difficulty": "Easy",
      "topic": "Appointments",
      "category": "Current_Affairs",
      "subject": "General_Awareness"
    }
  ]
}
```
- **Key Fields:** `topic`, `category`, `difficulty`, `question_id`
- **Total Questions:** 803
- **Topics:** 38 different topics (Fiscal_Policy, Economic_Updates, Government_Schemes, etc.)

---

#### **C. Reasoning Master** (`reasoning_master.json`):
```json
{
  "metadata": {...},
  "questions": [
    {
      "question_id": "BR_001",
      "question": "...",
      "options": {...},
      "correct_answer": "B",
      "difficulty": "Easy",
      "topic": "Blood Relations",
      "reasoning_topic": "Blood Relations",
      "main_category": "Verbal & Logical Reasoning",
      "subject": "Reasoning"
    }
  ]
}
```
- **Key Fields:** `topic` or `reasoning_topic`, `difficulty`, `question_id`
- **Total Questions:** 604
- **Topics:** 18 different topics (Blood Relations, Linear Seating, Syllogisms, etc.)

---

#### **D. Arithmetic Master** (`arithmetic_master.json`):
```json
{
  "category": "Arithmetic",
  "statistics": {...},
  "questions": [
    {
      "question_id": "ARIT_0001",
      "question": "...",
      "options": {...},
      "correct_answer": "A",
      "difficulty": "Medium",
      "topic": "Averages",
      "sub_topic": "Effect of adding/removing values",
      "subject": "Arithmetic"
    }
  ]
}
```
- **Key Fields:** `topic`, `sub_topic`, `difficulty`, `question_id`
- **Total Questions:** 100
- **Topics:** 8 topics (Averages, Simple & Compound Interest, Percentage, etc.)

---

#### **E. Data Interpretation Master** (`di_master.json`):
```json
{
  "category": "Data Interpretation",
  "statistics": {...},
  "questions": [
    {
      "di_set_id": "DI_BAR_CHART_001",
      "topic": "Bar Chart - Sales Revenue Analysis",
      "difficulty": "Easy",  // ‚Üê SET LEVEL (IGNORE THIS)
      "data_source": {...},
      "questions": [
        {
          "question_id": "DI_BAR_001_Q1",
          "question": "...",
          "options": {...},
          "correct_answer": "A",
          "difficulty": "Easy",  // ‚Üê QUESTION LEVEL (USE THIS)
          "explanation": "..."
        },
        {
          "question_id": "DI_BAR_001_Q2",
          "difficulty": "Easy"  // ‚Üê QUESTION LEVEL (USE THIS)
        }
        // ... 3 more questions (total 5 per set)
      ]
    }
  ]
}
```
- **Key Fields:** `di_set_id`, `topic` (at set level), `difficulty` (at question level)
- **Total Questions:** 25 sets √ó 5 questions = 125 questions
- **Topics:** 25 different topics (all variations of Bar Chart, Pie Chart, Line Chart, Table, Caselet)
- **Special:** Each set is atomic (all 5 questions together)

---

### **7. DI Topic Selection** ‚úÖ
- **Option C Selected:** Use generic "Data Interpretation" tag
- All DI sets are treated equally regardless of specific chart type
- Engine randomly picks any valid DI sets that fit the difficulty footprint
- **Alternative (if needed later):** Can specify exact types in blueprint like:
  ```json
  "Bar Chart": 1,
  "Pie Chart": 1
  ```

---

### **8. Blueprint Storage** ‚úÖ
- **Location:** `data/blueprints/`
- **Naming:** `RBI_P1_MOCK_01.json`, `RBI_P1_MOCK_02.json`, etc.
- One JSON file per test blueprint

---

### **9. Blueprint Topic Distribution Format** ‚úÖ
- **Option A Selected:** Simple count format
```json
"topic_distribution": {
  "Linear Seating Arrangement": 8,
  "Syllogisms": 5,
  "Data Interpretation": 2  // 2 sets = 10 questions
}
```
- Engine automatically applies section's difficulty ratio to each topic
- Simpler and less error-prone

---

### **10. Output Format - Grouped by Section** ‚úÖ
```json
{
  "test_id": "RBI_P1_MOCK_01",
  "test_name": "RBI Grade B - Phase 1 Mock Test #1",
  "description": "Full-length mock test as per latest pattern",
  "total_questions": 200,
  "total_marks": 200,
  "duration_minutes": 120,
  "negative_marking": 0.25,
  "generation_date": "2025-10-07T...",
  "sections": [
    {
      "section_id": "GA",
      "section_name": "General Awareness",
      "total_questions": 80,
      "questions": [/* 80 question objects */]
    },
    {
      "section_id": "LR",
      "section_name": "Logical Reasoning",
      "total_questions": 60,
      "questions": [/* 60 question objects */]
    },
    {
      "section_id": "ENG",
      "section_name": "English Language",
      "total_questions": 30,
      "questions": [/* 30 question objects */]
    },
    {
      "section_id": "QUANT",
      "section_name": "Quantitative Aptitude",
      "total_questions": 30,
      "questions": [/* 30 questions including 2 DI sets */]
    }
  ]
}
```

---

### **11. Question Metadata in Output** ‚úÖ
- **Include ALL metadata** in output JSON:
  - `correct_answer` ‚úÖ
  - `explanation` ‚úÖ
  - `difficulty` ‚úÖ
  - `topic` ‚úÖ
  - All other fields from master files ‚úÖ

- **Frontend Responsibility:**
  - Hide sensitive fields during test (correct_answer, explanation, difficulty)
  - Reveal everything after submission for review

---

### **12. Validation & Error Handling** ‚úÖ
- **Hard fail** with clear error messages if:
  - Master file doesn't exist
  - Not enough questions for a topic
  - Not enough questions for a difficulty level
  - Topic counts don't sum to total_questions
  - DI set doesn't have exactly 5 questions
  - Invalid blueprint structure

- **Error Message Format:**
  ```
  ‚ùå ERROR: Insufficient questions for section "Reasoning"
     Topic: "Linear Seating Arrangement"
     Required: 8 Easy questions
     Available: 5 Easy questions
     Missing: 3 Easy questions
  ```

---

### **13. Master File Locations** ‚úÖ
```
data/generated/master_questions/
‚îú‚îÄ‚îÄ english_master.json          (290 questions)
‚îú‚îÄ‚îÄ general_awareness_master.json (803 questions)
‚îú‚îÄ‚îÄ reasoning_master.json         (604 questions)
‚îú‚îÄ‚îÄ arithmetic_master.json        (100 questions)
‚îî‚îÄ‚îÄ di_master.json                (25 sets = 125 questions)
```

---

### **14. Special DI Handling in Quant Section** ‚úÖ
- Quant section uses **2 source files:**
  - `arithmetic_master.json` (standalone questions)
  - `di_master.json` (DI sets)

- **Blueprint Example:**
```json
{
  "section_name": "Quantitative Aptitude",
  "total_questions": 30,
  "source_files": ["arithmetic_master.json", "di_master.json"],
  "topic_distribution": {
    "Data Interpretation": 2,  // 2 sets = 10 questions
    "Averages": 5,
    "Percentage": 5,
    "Profit & Loss": 5,
    "Ratio & Proportion": 5
  },
  "difficulty_distribution": {
    "Easy": 10,
    "Medium": 15,
    "Hard": 5
  }
}
```

- **Engine Logic:**
  1. First, pick 2 DI sets (10 questions) using footprint matching
  2. Update difficulty quotas after DI sets
  3. Fill remaining 20 questions from arithmetic topics

---

## **üéØ What You Need Me to Code:**

### **Phase 1: Core Engine**
1. ‚úÖ **Blueprint Validator** - Validates blueprint JSON structure
2. ‚úÖ **Master File Loader** - Loads and parses all 5 master file formats
3. ‚úÖ **Question Selector** - Selects questions based on topic/difficulty
4. ‚úÖ **DI Set Selector** - Implements footprint matching algorithm
5. ‚úÖ **Test Assembler** - Combines everything into final test JSON
6. ‚úÖ **Main Engine** - Orchestrates the entire process

### **Phase 2: Sample Blueprints**
1. ‚úÖ `RBI_P1_MOCK_01.json` - First mock test blueprint
2. ‚úÖ `RBI_P1_MOCK_02.json` - Second mock test blueprint
3. ‚úÖ `RBI_P1_MOCK_03.json` - Third mock test blueprint

### **Phase 3: Output**
1. ‚úÖ Generated test JSON files in `data/generated/tests/`
2. ‚úÖ Validation reports
3. ‚úÖ Statistics (questions used, difficulty distribution, etc.)

---

File Strucutre 
rbi-test-generator/
‚îÇ
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ generated/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ master_questions/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ english_master_question_bank.json              (290 questions - your existing file)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ general_awareness_master_question_bank.json    (803 questions - your existing file)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ reasoning_master_question_bank.json            (604 questions - your existing file)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ arithmetic_master._question_bankjson           (100 questions - your existing file)
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ di_master_question_bank.json                   (25 sets = 125 questions - your existing file)
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ tests/                               (Generated tests will be saved here)
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ RBI_P1_MOCK_01.json              (Generated by engine)
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ RBI_P1_MOCK_02.json              (Generated by engine)
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ RBI_P1_MOCK_03.json              (Generated by engine)
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ blueprints/                              (Test blueprints/configurations)
‚îÇ       ‚îú‚îÄ‚îÄ RBI_P1_MOCK_01.json                  (Blueprint for Mock 1)
‚îÇ       ‚îú‚îÄ‚îÄ RBI_P1_MOCK_02.json                  (Blueprint for Mock 2)
‚îÇ       ‚îî‚îÄ‚îÄ RBI_P1_MOCK_03.json                  (Blueprint for Mock 3)
‚îÇ
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îî‚îÄ‚îÄ test_engine/
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îú‚îÄ‚îÄ blueprint_validator.py               (Validates blueprint structure)
‚îÇ       ‚îú‚îÄ‚îÄ master_loader.py                     (Loads all master files)
‚îÇ       ‚îú‚îÄ‚îÄ question_selector.py                 (Selects questions by topic/difficulty)
‚îÇ       ‚îú‚îÄ‚îÄ di_selector.py                       (DI set footprint matching)
‚îÇ       ‚îú‚îÄ‚îÄ test_assembler.py                    (Assembles final test)
‚îÇ       ‚îî‚îÄ‚îÄ main_engine.py                       (Main orchestrator)
‚îÇ
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îî‚îÄ‚îÄ generate_mocks.py                        (Script to generate all 3 mocks)
‚îÇ
‚îú‚îÄ‚îÄ logs/
‚îÇ   ‚îú‚îÄ‚îÄ mock_01_generation.log                   (Generation logs)
‚îÇ   ‚îú‚îÄ‚îÄ mock_02_generation.log
‚îÇ   ‚îî‚îÄ‚îÄ mock_03_generation.log
‚îÇ
‚îî‚îÄ‚îÄ requirements.txt                             (Python dependencies)
